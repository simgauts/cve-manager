from flask_wtf import FlaskForm
from wtforms import StringField, PasswordField, BooleanField, SubmitField, TextAreaField
from wtforms.validators import ValidationError, DataRequired, Email, EqualTo, Length
from app.models.cve import Cve  

class EditCveForm(FlaskForm):
    identifier = StringField('Identifier', validators=[DataRequired(), Length(min=6, max=64)])
    description = TextAreaField('Description', validators=[Length(min=0, max=512)])
    extra_description = TextAreaField('Extra Description', validators=[Length(min=0, max=512)])
    submit = SubmitField('Submit')

    #def __init__(self, original_identifier, *args, **kwargs):
    #    super(EditCveForm, self).__init__(*args, **kwargs)
    #    self.original_identifier = original_identifier

    #def validate_identifier(self, identifier):
    #    if identifier.data != self.original_identifier:
    #        cve = Cve.query.filter_by(identifier=self.identifier.data).first()
    #        if cve is not None:
    #            raise ValidationError('Identifier already exist.') 