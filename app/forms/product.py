from flask_wtf import FlaskForm
from wtforms import StringField, SubmitField, TextAreaField
from wtforms.validators import ValidationError, DataRequired, Length
from app.models.cve import Cve


class EditProductForm(FlaskForm):
    name = StringField("Name", 
                        validators=[DataRequired(), Length(min=1, max=64)]
    )
    description = TextAreaField("Description", 
                        validators=[Length(min=0, max=128)]
    )
    submit = SubmitField("Submit")

    #def __init__(self, original_identifier, *args, **kwargs):
    #    super(EditCveForm, self).__init__(*args, **kwargs)
    #    self.original_identifier = original_identifier

    #def validate_identifier(self, identifier):
    #    if identifier.data != self.original_identifier:
    #        cve = Cve.query.filter_by(identifier=self.identifier.data).first()
    #        if cve is not None:
    #            raise ValidationError("Identifier already exist.")
